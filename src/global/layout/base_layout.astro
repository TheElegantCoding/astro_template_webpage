---
import Favicon from '@global/component/favicon.astro';
import OpenGraph, { type OpenGraphProps } from '@global/component/open_graph.astro';
import { siteConfiguration } from '@global/configuration/site_configuration';
import { BASE_URL } from '@global/constant/base';
import { joinString } from '@global/util/join_string.ts';

import Show from '@global/component/show.astro';
import GoogleAnalytic from '@global/component/google_analytic.astro';
import './../style/main.scss';

type Props =
{
  readonly title: string;
  readonly keywords: string;
  readonly metaRobot?:
  {
    noIndex: boolean;
    noFollow: boolean;
  };
  readonly description: string;
  readonly openGraphConfiguration?: OpenGraphProps;
};

const {
  description,
  keywords,
  metaRobot,
  title,
  openGraphConfiguration
} = Astro.props;

const {
  author,
  googleSiteVerificationId
} = siteConfiguration;

const canonicalURL = new URL(Astro.url.pathname, Astro.site);
---
<!doctype html>
<html
  lang={siteConfiguration.defaultLocale}
  dir='ltr'
>
  <head>
    <meta charset='utf-8' />
    <meta
      name='viewport'
      content='width=device-width, initial-scale=1, viewport-fit=cover'
    />
    <meta
      http-equiv='X-UA-Compatible'
      content='IE=edge'
    />
    <meta
      name='robots'
      content={joinString([
        metaRobot?.noIndex ? 'noindex' : 'index',
        metaRobot?.noFollow ? 'nofollow' : 'follow'
      ])}
    />
    <Show when={author.name || author.email || author.web}>
      <meta
        name='author'
        content={joinString([author.name, author.email, author.web])}
      />
    </Show>
    <meta
      name='description'
      content={description}
    />
    <meta
      name='keywords'
      content={keywords}
    />
    <Show when={googleSiteVerificationId}>
      <meta
        name="google-site-verification"
        content={googleSiteVerificationId}
      />
    </Show>
    <link
      rel='sitemap'
      href=`${BASE_URL}/sitemap-index.xml`
    />
    <link
      rel="alternate"
      type="application/rss+xml"
      title={siteConfiguration.siteName}
      href={`${BASE_URL}/rss.xml`}
    />
    <link
      rel='alternate'
      href={canonicalURL}
      hreflang='x-default'
    />
    <link
      rel='canonical'
      href={canonicalURL}
    />
    <Favicon />
    <OpenGraph
      title={title}
      description={description}
      image={[
        {
          url: '/asset/opg/home.png',
          type: 'image/png',
          width: '1200',
          height: '630',
          secureUrl: '/asset/opg/home.png',
          alt: 'Logo de loyalty latino'
        }
      ]}
      {...openGraphConfiguration}
    />
    <GoogleAnalytic />
    <slot name='head' />
    <title>{title}</title>
  </head>
  <body>
    <slot />
  </body>
</html>